<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <!--to Research WorkGiverDef-->
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/WorkGiverDef[defName = "Research"]/giverClass</xpath>
        <value>
          <giverClass>HumanResources.WorkGiver_ResearchTech</giverClass>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <xpath>/Defs/WorkGiverDef[defName = "Research"]</xpath>
        <value>
          <fixedBillGiverDefs>
            <li>SimpleResearchBench</li>
            <li>HiTechResearchBench</li>
          </fixedBillGiverDefs>
        </value>
      </li>
    </operations>
  </Operation>

  <!--to Stats_Building_Special-->
  <Operation Class="PatchOperationAdd">
    <xpath>*/StatDef[defName = "ResearchSpeedFactor"]/parts</xpath>
    <value>
      <li Class="HumanResources.StatPart_AvailableBooks" />
    </value>
  </Operation>

  <!--to Buildings_Production-->
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench" or defName = "HiTechResearchBench"]/thingClass</xpath>
        <value>
          <thingClass>Building_WorkTable</thingClass>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench" or defName = "HiTechResearchBench"]</xpath>
        <value>
          <inspectorTabs>
            <li>ITab_Bills</li>
          </inspectorTabs>
        </value>
      </li>
      <li Class="PatchOperationConditional">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench"]/comps</xpath>
        <match Class="PatchOperationConditional">
          <xpath>/Defs/ThingDef[defName = "SimpleResearchBench"]/comps/li/linkableFacilities</xpath>
          <nomatch Class="PatchOperationAdd">
            <xpath>/Defs/ThingDef[defName = "SimpleResearchBench"]/comps</xpath>
            <value>
              <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities />
              </li>
            </value>
          </nomatch>
        </match>
        <nomatch Class="PatchOperationAdd">
          <xpath>/Defs/ThingDef[defName = "SimpleResearchBench"]</xpath>
          <value>
            <comps>
              <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities />
              </li>
            </comps>
          </value>
        </nomatch>
      </li>
      <li Class="PatchOperationAdd">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench" or defName = "HiTechResearchBench"]/comps/li/linkableFacilities</xpath>
        <value>
          <li>BookShelf</li>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench" or defName = "HiTechResearchBench"]/size</xpath>
        <value>
          <size>(3,1)</size>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench" or defName = "HiTechResearchBench"]/graphicData/drawSize</xpath>
        <value>
          <drawSize>(3.5,1.5)</drawSize>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName = "SimpleResearchBench"]/graphicData/texPath</xpath>
        <value>
          <texPath>Things/Building/ResearchBenchSimple</texPath>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <xpath>/Defs/ThingDef[defName = "HiTechResearchBench"]/graphicData/texPath</xpath>
        <value>
          <texPath>Things/Building/ResearchBenchHiTech</texPath>
        </value>
      </li>
    </operations>
  </Operation>

  <!--to TraderKinds-->
  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/TraderKindDef[defName = "Caravan_Outlander_Exotic" or defName = "Orbital_Exotic"]/stockGenerators</xpath>
    <value>
      <li Class="HumanResources.StockGenerator_TechBooks">
        <countRange>
          <min>10</min>
          <max>10</max>
        </countRange>
      </li>

      <!--<li Class="StockGenerator_Tag">
        <tradeTag>TechBook</tradeTag>
        <thingDefCountRange>
          <min>1</min>
          <max>1</max>
        </thingDefCountRange>
        <countRange>
          <min>1</min>
          <max>1</max>
        </countRange>
      </li>-->
      <!--<li Class="StockGenerator_Category">
        <categoryDef>Knowledge</categoryDef>
        <excludedCategories>
          <li>Ultra</li>
          <li>Archotech</li>
        </excludedCategories>
        <thingDefCountRange>1~3</thingDefCountRange>
        <countRange>1~1</countRange>
      </li>-->
    </value>
  </Operation>>
</Patch>